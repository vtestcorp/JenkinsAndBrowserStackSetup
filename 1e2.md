## authentication service - multi-factor authentication component - secure

## UI locks user for guessing codes frequently

1. Open {{ENV}}.qa.solvexia.com
2. Enter correct username and password
3. Enter invalid code for morethan 3 times

`User should be blocked for guessing codes frequently`

## UI throws warning message for invalid two factor code

1. Open {{ENV}}.qa.solvexia.com
2. Enter correct username and password
3. Enter invalid two factor code 

`User should get warning message "invalid code"`

## UI does not allow user to reuse same 2FA code for multiple times

1. Open {{ENV}}.qa.solvexia.com 
2. Enter correct username and password
3. Log in to the same account another browser with the same code

`User should be allowed to login `

## UI does not allow user to login with invalid 2FA code

1. Open {{ENV}}.qa.solvexia.com 
2. Enter correct username and password
3. Enter invalid 2FA code 

`User should get warning message "invalid code"`

## UI does not allow user to login with expired 2FA code

1. Open {{ENV}}.qa.solvexia.com 
2. Enter correct username and password
3. Enter expired 2FA code 

`User should get warning message "invalid code"`

## UI does not allow user to login with another accout 2FA code

1. Open {{ENV}}.qa.solvexia.com 
2. Enter correct username and password
3. Enter another account 2FA code 

`User should get warning message "invalid code"`

## UI does not allow user to login  with previously used  2FA code

1. Open {{ENV}}.qa.solvexia.com 
2. Enter correct username and password
3. Enter previously used 2FA code 

`User should get warning message "invalid code"`

## UI throws warning message while user tries to give invalid phone number for MFA setup

1. Enter letters and special characters in phone number field

`User should get a warning message when invalid phone number is given`

## UI allows user to login to the application with valid code from authenticator app

1. Open staff-{{ENV}}.qa.solvexia.com
2. Login to the application with admin credentials 
3. Click on userid on top right corner
4. Navigate to  SolveXia Admin and click on Security and turn of MFA company wide 
5. Open {{ENV}}.qa.solvexia.com
6. Login to the application with valid credentials
7. Enter code from authenticator app

`User can login to the application with valid code from authenticator app`

## UI allows user to Enter correct code with setup, starting from login url with redirect 

1. Enter login with url? redirect_uri=https://www.google.com
2. Enter username/password for user already not set up 2fa yet but needs to
3. Go through mobile setup process
4. Enter correct mfa code

`User should be able to redirect on providing the correct mfa code `

##  UI allows user to Enter correct code with no setup starting from login url with redirect

1. Enter login with url? redirect_uri=https://www.google.com
2. Enter username/password for user already set up 2fa 
3. Enter correct mfa code

`User should be able to redirect with correct code `

## UI does not allow to login to application with incorrect MFA code format

1. Open {{ENV}}.qa.solvexia.com
2. Enter username in username field
3. Enter password in password field
4. Click on Sign in button 
5. Enter invalid MFA code for ex: letters

`User should get a warning message when trying to login with  incorrect MFA code format`

## UI does not allow user to login to application without MFA code when MFA is enabled

1. Open {{ENV}}.qa.solvexia.com
2. Enter username in username field
3. Enter password in password field
4. Click on Sign in button 
5. Click on submit button without entering MFA code

`User should get a warning message to enter MFA code`

## UI allows user to Enter correct code, after entering incorrect code
 
1. Open {{ENV}}.qa.solvexia.com
2. Enter username in username field
3. Enter password in password field
4. Click on Sign in button 
5. Click on submit button by entering invalid MFA code
6. Click on submit button by entering valid MFA code

`User should be able to enter correct code, after entering incorrect code`


 
 


